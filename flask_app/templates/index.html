<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VGG19 Image Classification</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen py-8 px-4">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-4xl font-bold text-gray-900 text-center mb-8">VGG19 Image Classification System</h1>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Training Configuration</h2>
                    
                    <div id="datasetStatus" class="mb-4 p-3 rounded">
                        <p class="text-sm font-medium">
                            Dataset Status: 
                            <span id="datasetStatusText" class="font-bold">
                                {% if dataset_ready %}
                                    <span class="text-green-600">Ready</span>
                                {% else %}
                                    <span class="text-yellow-600">Not Prepared</span>
                                {% endif %}
                            </span>
                        </p>
                    </div>
                    
                    <div id="modelStatus" class="mb-4 p-3 rounded">
                        <p class="text-sm font-medium">
                            Model Status: 
                            <span id="modelStatusText" class="font-bold">
                                {% if model_ready %}
                                    <span class="text-green-600">Trained Model Available</span>
                                {% else %}
                                    <span class="text-gray-600">No trained model yet</span>
                                {% endif %}
                            </span>
                        </p>
                    </div>
                    
                    {% if not dataset_ready %}
                    <button id="prepareDatasetBtn" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 px-4 rounded mb-4">
                        Prepare Dataset
                    </button>
                    {% endif %}
                    
                    <form id="trainForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Epochs</label>
                            <input type="number" id="epochs" name="epochs" value="25" min="1" max="100" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Learning Rate</label>
                            <input type="number" id="learning_rate" name="learning_rate" value="0.001" step="0.0001" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Batch Size</label>
                            <input type="number" id="batch_size" name="batch_size" value="32" min="1" max="128" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        
                        <div class="flex items-center">
                            <input type="checkbox" id="continue_training" name="continue_training" 
                                   class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                            <label for="continue_training" class="ml-2 block text-sm text-gray-700">
                                Continue training from existing model
                            </label>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">
                            Jika dicentang, training akan melanjutkan dari model yang sudah dilatih sebelumnya (jika ada). Jika tidak dicentang, training dimulai dari pretrained ImageNet.
                        </p>
                        
                        <button type="submit" id="trainBtn" 
                                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded transition duration-200">
                            Start Training
                        </button>
                    </form>
                    
                    <div id="trainingStatus" class="mt-4 hidden">
                        <div class="bg-blue-50 border border-blue-200 rounded p-4">
                            <p class="text-blue-800 font-medium">Training in progress...</p>
                            <div class="mt-2 w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-600 h-2 rounded-full animate-pulse" style="width: 100%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="trainingResults" class="mt-4 hidden">
                        <div class="bg-green-50 border border-green-200 rounded p-4 space-y-2">
                            <h3 class="font-semibold text-green-800 mb-2">Training Results</h3>
                            <p class="text-sm text-gray-700"><span class="font-medium">Training Time:</span> <span id="trainTime"></span>s</p>
                            <p class="text-sm text-gray-700"><span class="font-medium">Testing Time:</span> <span id="testTime"></span>s</p>
                            <p class="text-sm text-gray-700"><span class="font-medium">Accuracy:</span> <span id="accuracy"></span></p>
                            <p class="text-sm text-gray-700"><span class="font-medium">Precision:</span> <span id="precision"></span></p>
                            <p class="text-sm text-gray-700"><span class="font-medium">Recall:</span> <span id="recall"></span></p>
                            <p class="text-sm text-gray-700"><span class="font-medium">F1-Score:</span> <span id="f1Score"></span></p>
                            <p class="text-sm text-gray-700"><span class="font-medium">ROC-AUC:</span> <span id="rocAuc"></span></p>
                        </div>
                    </div>
                    
                    <div id="errorMsg" class="mt-4 hidden">
                        <div class="bg-red-50 border border-red-200 rounded p-4">
                            <p class="text-red-800 text-sm" id="errorText"></p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Image Prediction</h2>
                    
                    <form id="predictForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upload Image</label>
                            <input type="file" id="imageFile" name="image" accept="image/*" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        
                        <div id="imagePreview" class="hidden">
                            <img id="previewImg" src="" alt="Preview" class="w-full h-64 object-contain border rounded">
                        </div>
                        
                        <button type="submit" id="predictBtn" 
                                class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded transition duration-200">
                            Predict
                        </button>
                    </form>
                    
                    <div id="predictionStatus" class="mt-4 hidden">
                        <div class="bg-blue-50 border border-blue-200 rounded p-4">
                            <p class="text-blue-800 font-medium">Processing...</p>
                        </div>
                    </div>
                    
                    <div id="predictionResults" class="mt-4 hidden">
                        <div class="bg-green-50 border border-green-200 rounded p-4">
                            <h3 class="font-semibold text-green-800 mb-3">Prediction Results</h3>
                            <div class="space-y-2">
                                <div class="bg-white p-3 rounded border">
                                    <p class="text-lg font-bold text-gray-800" id="predictedClass"></p>
                                    <p class="text-sm text-gray-600">Confidence: <span id="confidence" class="font-semibold"></span></p>
                                </div>
                                <div class="bg-white p-3 rounded border">
                                    <p class="text-sm font-medium text-gray-700 mb-2">Top 3 Predictions:</p>
                                    <div id="top3Predictions" class="space-y-1"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="predictError" class="mt-4 hidden">
                        <div class="bg-red-50 border border-red-200 rounded p-4">
                            <p class="text-red-800 text-sm" id="predictErrorText"></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Training Visualizations</h2>
                
                <div class="mb-4">
                    <button id="loadMetricsBtn" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-4 rounded">
                        Load Metrics
                    </button>
                </div>
                
                <div id="visualizations" class="hidden grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <h3 class="text-lg font-medium text-gray-700 mb-2">Training History</h3>
                        <img id="historyPlot" src="/results/training_history.png" alt="Training History" class="w-full border rounded">
                    </div>
                    <div>
                        <h3 class="text-lg font-medium text-gray-700 mb-2">Confusion Matrix</h3>
                        <img id="confusionMatrix" src="/results/confusion_matrix.png" alt="Confusion Matrix" class="w-full border rounded">
                    </div>
                </div>
                
                <div id="metricsText" class="mt-4 hidden">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Detailed Metrics</h3>
                    <pre id="metricsContent" class="bg-gray-50 p-4 rounded border text-sm overflow-x-auto"></pre>
                </div>
            </div>
        </div>
    </div>
    
    <script src="/static/js/main.js"></script>
</body>
</html>

